generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:plo43754@localhost:5432/scholar?schema=public"
}

model Usuario {
  id           Int        @id @default(autoincrement())
  nome         String
  matricula    String     @unique
  senha        String

  aluno        Aluno?     @relation(fields: [alunoId], references: [id])
  alunoId      Int?       @unique

  professor    Professor? @relation(fields: [professorId], references: [id])
  professorId  Int?       @unique
}


model Curso {
  id            Int         @id @default(autoincrement())
  nome          String      @unique // Nome do curso deve ser único
  area          String
  duracaoAnos   Int         // Duração em anos
  coordenador   String
  alunos        Aluno[]     // Lista de alunos vinculados a este curso
}

model Aluno {
  id        Int      @id @default(autoincrement())
  nome      String
  matricula String   @unique
  // O campo 'curso' string deve ser removido ou alterado
  
  cursoId   Int?       // NOVO: ID do curso de destino
  curso     Curso?     @relation(fields: [cursoId], references: [id]) // NOVO: Relação com a tabela Curso

  notas     Nota[]

  // RELAÇÃO INVERSA COM USUARIO
  usuario   Usuario?
}
model Professor {
  id            Int       @id @default(autoincrement())
  nome          String
  titulacao     String
  tempoDocencia Int
  disciplinas   Disciplina[]
  usuario       Usuario?
}

model Disciplina {
  id        Int     @id @default(autoincrement())
  nome      String
  carga     Int

  professorId Int?
  professor  Professor? @relation(fields: [professorId], references: [id])

  notas     Nota[]
}

model Nota {
  id            Int        @id @default(autoincrement())
  alunoId       Int
  disciplinaId  Int
  n1            Float
  n2            Float
  n3            Float
  faltas        Int       @default(0) // CORREÇÃO APLICADA AQUI
  
  aluno         Aluno       @relation(fields: [alunoId], references: [id])
  disciplina    Disciplina  @relation(fields: [disciplinaId], references: [id])
}
